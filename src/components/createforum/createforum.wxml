<import src="../module/module.wxml" />
<import src="../classifications/classifications.wxml" />

<!-- 版块列表 -->
<view wx:if="{{isForumlist}}">
    <!-- 版块列表 -->
    <view wx:for="{{forumList}}" wx:for-item="forum" class="createforum-forumlist-card">
        <view class="createforum-forumlist-card-title">{{forum.board_category_name}}</view>
        <view class="createforum-forum-item-container">
            <block wx:for="{{forum.board_list}}">
                <view class="createforum-forum-item" bindtap="createforum_selectedChange"  data-fid="{{item.board_id}}" data-boardname="{{item.board_name}}" data-event-key="{{key}}">
                    <view class="createforum-forum-item-image">
                        <image src="{{item.board_img || iconSrc + 'default_plate.png'}}"></image>
                    </view>
                    <view class="createforum-forum-item-text">
                        {{item.board_name}}
                    </view>
                </view>
            </block>
        </view>
    </view>
</view>

<!-- 分类信息 -->
<view wx:if="{{!isForumlist && isTopicPanel}}">
    <block wx:for="{{topicPanelList}}">
        <view class="createforum-topic-panel" bindtap="createforum_selectClassInfo" data-event-key="{{key}}" data-classinfoid="{{item.actionId}}" data-classinfoname="{{item.title}}" data-classinfotype="{{item.type}}">
            <view class="createforum-topic-icon">
                <image src="{{item.board_img || iconSrc + 'default_plate.png'}}"></image>
            </view>
            <view class="createforum-topic-text">{{item.title}}</view>
        </view>
    </block>
</view>    

<!-- 发帖 -->
<block wx:if="{{!isForumlist && !isTopicPanel && isPublish}}">
    <view class="createforum-publish-content">
        <input class="createforum-publish-title  weapp-border-bottom" type="text" bindinput="createforum_changeTitle" data-event-key="{{key}}" placeholder="#点击添加标题#" placeholder-class="createforum-publish-title-placeholder" />

        <block wx:for="{{publishInfo}}" wx:for-index="idx" >
            <template is="classifications" data="{{...children['classificaid'+idx], ...item }}"></template>
        </block>
        <!--  展示图文混合 -->
        <scroll-view scroll-y="true" style="height: 200px;" catchtap="createforum_showTools" data-event-key="{{key}}">
            <block wx:for="{{contentText}}" wx:key="contentTextId">
                <view class="createforum-publish-view-text" wx:if="{{item.type === 0}}" data-view-id="{{item.contentTextId}}" style="background: {{selectItemId == item.contentTextId ? 'rgba(255,204,0,.5)': ''}};">
                    {{item.value}}
                </view>
                <view class="createforum-publish-view-null" wx:if="{{item.type === 9}}" data-view-id="{{item.contentTextId}}" style="background: {{selectItemId == item.contentTextId ? 'rgba(255,204,0,.5)': ''}};">
                </view>
                <image class="createforum-publish-view-image" wx:if="{{item.type === 1}}" data-view-id="{{item.contentTextId}}" style="background: {{selectItemId == item.contentTextId ? 'rgba(255,204,0,.5)': ''}};" src="{{item.value}}" mode="widthFix" />
            </block>
        </scroll-view>
    </view>


    <view class="createforum-publish-tools weapp-border-top" hidden="{{!showInputTools}}">
        <view class="createforum-publish-tools-nav weapp-border-bottom" catchtap="createforum_changeInputType" data-event-key="{{key}}" >
            <view class="createforum-list" data-type="textInput">
                A
            </view>
            <view class="createforum-list">
                <image src="{{iconSrc}}new_publish_pic.png" data-type="pictureSelected" mode="aspectFill"/>
            </view>
            <view class="createforum-list">
                <image src="{{iconSrc}}new_publish_@.png" mode="aspectFill"/>
            </view>
            <view class="createforum-list">
                <image src="{{iconSrc}}new_publish_record.png" mode="aspectFill"/>
            </view>
            <view class="createforum-list">
                <image src="{{iconSrc}}new_publish_video.png" mode="aspectFill"/>
            </view>
            <view class="createforum-list">
                <image src="{{iconSrc}}new_publish_vote.png" mode="aspectFill"/>
            </view>
            <view class="createforum-list" >
                <image src="{{iconSrc}}new_publish_close.png" data-type="hidden" mode="aspectFill"/>
            </view>
        </view>
        <!-- 文本编辑 -->
        <view  wx:if="{{textInput}}">
            <input type="text" value="{{textInputInfo}}" placeholder="说点什么吧。。。。" bindinput="createforum_bindInput" data-event-key="{{key}}"/>
            <button bindtap="createforum_bindconfirm" data-event-key="{{key}}" >完成</button>
        </view>

        <view wx:if="{{pictureSelected}}">
            <scroll-view class="createforum-upload-images-container" scroll-x="true" style="width: 100%">

                <block wx:for="{{ imagelist }}" wx:for-index="idx" wx:key="*this">
                    <view class="createforum-upload-images">
                        <image src="{{item}}" mode="aspectFill" class="createforum-upload-images" bindtap="createforum_previewImage" data-event-key="{{key}}" data-current-url="{{item}}" />

                        <view class="delete-upload-btn" wx:if="{{deleteUrl === item}}" bindtap="createforum_deleteImage" data-event-key="{{key}}" data-current-url="{{item}}">x</view>
                    </view>

                </block>
                
            </scroll-view>

            <view>
                <button bindtap="createforum_chooseImg" size="mini" data-event-key="{{key}}">添加图片</button>
                <button bindtap="createforum_chooseImageOver"  size="mini" data-event-key="{{key}}" >完成</button>
            </view>
        </view>

       
    </view>


    <view class="createforum-publish-item" >
        <view class="createforum-publish-item-title">板块信息</view>
        <view >{{ boardname +'  '+ classinfoname}}</view>
    </view>

    <view wx:if="{{topicList.length}}" class="createforum-publish-topicList">
        <view class="createforum-topic-label">主题</view>
        <view class="createforum-topic-list">
            <block wx:for="{{topicList}}" wx:for-item="topic" wx:key="classificationType_id">
                <view class="createforum-topic-item {{selectTopicId == topic.classificationType_id ? 'createforum-action' : ''}}" bindtap="createforum_selectTopicId" wx:key="classificationType_id" data-event-key="{{key}}" data-topic-id="{{topic.classificationType_id}}">{{topic.classificationType_name}}</view>
            </block>
        </view>
    </view>

    <button bindtap="createforum_submit" data-event-key="{{key}}" class="publish-submit-btn" style="background:{{appColor}}">发　 布</button>
</block>